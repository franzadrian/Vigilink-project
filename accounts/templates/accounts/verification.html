{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verification - VigiLink</title>
    <link rel="stylesheet" href="{% static 'accounts/css/verification_styles.css' %}">
    <link rel="icon" type="image/x-icon" href="{% static 'favicon/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon/apple-touch-icon.svg' %}">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="{% static 'favicon/shield.svg' %}">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="{% static 'favicon/favicon-16x16.svg' %}">
    <link rel="manifest" href="{% static 'favicon/site.webmanifest' %}">
</head>
<body>
    <header class="header">
        <div class="logo">
            <img src="{% static 'accounts/images/vigilink_logo.png' %}" alt="VigiLink Logo" class="logo-image">
            VigiLink
        </div>
        <nav class="nav">
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
        </nav>
    </header>

    <main class="main-container">
        <div class="verification-card">
            <h1 class="verification-title">VERIFICATION</h1>
            
            <form method="post" action="{% url 'verify_email' %}">
                {% csrf_token %}
                <div class="code-input-container">
                    <input type="text" class="code-input" name="digit1" maxlength="1" required />
                    <input type="text" class="code-input" name="digit2" maxlength="1" required />
                    <input type="text" class="code-input" name="digit3" maxlength="1" required />
                    <input type="text" class="code-input" name="digit4" maxlength="1" required />
                    <input type="text" class="code-input" name="digit5" maxlength="1" required />
                    <input type="text" class="code-input" name="digit6" maxlength="1" required />
                </div>

                <div class="verification-text">
                    <div class="subject-line">Subject: Email Verification Required</div>
                    <div>To complete your registration, please enter the 6-digit code sent to your email address.</div>
                    {% if messages %}
                    <div class="messages">
                        {% for message in messages %}
                        <div class="message {% if message.tags %}{{ message.tags }}{% endif %}">
                            {{ message }}
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="button-container">
                    <button type="submit" class="continue-btn">Verify Email</button>
                </div>
            </form>
            
            <form method="post" action="{% url 'resend_verification_code' %}" class="resend-form">
                {% csrf_token %}
                <button type="submit" class="resend-btn">Re-Send Code</button>
            </form>
        </div>

    </main>

    <script>
        // JavaScript for code input functionality
        const codeInputs = document.querySelectorAll('.code-input');
        
        codeInputs.forEach((input, index) => {
            // Auto-focus on first input when page loads
            if (index === 0) {
                setTimeout(() => input.focus(), 500);
            }
            
            // Move to next input after entering a digit
            input.addEventListener('input', (e) => {
                // Only allow numbers
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
                
                if (e.target.value.length === 1) {
                    if (index < codeInputs.length - 1) {
                        codeInputs[index + 1].focus();
                    } else {
                        // If it's the last input, blur to hide keyboard on mobile
                        input.blur();
                        // Optional: auto-submit the form when all digits are filled
                        // document.querySelector('form').submit();
                    }
                }
            });
            
            // Handle backspace to go to previous input
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
                    codeInputs[index - 1].focus();
                }
            });
            
            // Select all text when focused
            input.addEventListener('focus', (e) => {
                setTimeout(() => e.target.select(), 0);
            });
        });
    </script>
</body>
</html>