{% extends 'dashboard/base.html' %}

{% block title %}Communications - VigiLink{% endblock %}

{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'communication/css/user_communication.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
{% endblock %}

{% block content %}
{% csrf_token %}
<!-- Chat Content -->
<div class="chat-content" style="height: 100vh; display: flex; overflow: hidden;">
  <!-- User List -->
  <div id="user-list" class="user-list">
    <div class="user-list-search">
      <div class="search-wrapper">
        <i data-lucide="search" class="search-icon"></i>
        <input type="text" id="user-search" placeholder="Search users..." class="search-input">
      </div>
    </div>
    
    <div class="users-container">
      <div id="search-results">
        <!-- Users and conversations will be populated here -->
      </div>
    </div>
  </div>

  <!-- Chat Messages -->
  <div id="chat-messages" class="chat-messages hidden">
    <div class="messages-container" style="height: calc(100vh - 200px); overflow-y: auto;">
      <div id="messages-list" class="messages-list">
        <!-- Messages will be dynamically populated -->
      </div>
    </div>
    
    <!-- Message Input -->
    <div class="message-input-container">
      <form id="message-form" class="message-form">
        <div class="input-wrapper">
          <input type="text" id="message-input" placeholder="Type a message..." maxlength="1000" class="message-input">
          <div class="input-actions">
            <button type="button" class="input-btn">
              <i class="fas fa-image"></i>
            </button>
            <button type="button" class="input-btn">
              <i class="far fa-smile"></i>
            </button>
          </div>
        </div>
        <button type="submit" id="send-btn" class="send-btn">
          <i class="fas fa-paper-plane"></i>
        </button>
      </form>
    </div>
  </div>

  <!-- Welcome Screen -->
  <div id="welcome-screen" class="welcome-screen">
    <div class="welcome-content">
      <div class="welcome-icon">
        <i class="fas fa-comments welcome-shield-icon"></i>
      </div>
      <div class="welcome-text">
        <h3>Welcome to VigiLink Communications</h3>
        <p>Select a user to start a conversation</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'communication/js/user_search.js' %}"></script>
{% endblock %}